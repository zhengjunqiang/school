# 嵌入式操作系统及应用（第22号教案）
|课程名称|嵌入式操作系统及应用|嵌入式操作系统及应用|授课日期||
|---|---|---|---|---|
|班    级|物联网2411|物联网2412|物联网2411|物联网2412|课堂类型|一体化|
|教    材|OpenHarmony嵌入式系统原理与应用——基于RK2206芯片|OpenHarmony嵌入式系统原理与应用——基于RK2206芯片|OpenHarmony嵌入式系统原理与应用——基于RK2206芯片|OpenHarmony嵌入式系统原理与应用——基于RK2206芯片|
|章节名称|案例开发 重启控制|案例开发 重启控制|案例开发 重启控制|案例开发 重启控制|
|目的要求|1. 知识目标：掌握`RebootDevice()`函数的调用方法、头文件依赖（`reset.h`）及编译配置（`BUILD.gn`、`Makefile`修改）；理解小凌派-RK2206开发板重启机制（含看门狗初始化作用）。<br>2. 能力目标：能独立完成重启控制代码编写、编译烧录，能通过串口助手查看运行日志并排查基础问题；提升嵌入式系统软件实操与问题解决能力。<br>3. 素养目标：结合OpenHarmony国产软件应用，强化民族自豪感与科技报国情怀。|
|学情分析|1. 基础：学生已学习OpenHarmony基础理论与RK2206开发板基本操作，具备C语言编程与简单外设开发能力，能使用网络教学平台获取资源。<br>2. 薄弱点：对系统级函数（如`RebootDevice()`）的调用逻辑、编译配置文件（`BUILD.gn`）修改不熟悉；对“看门狗触发重启”的底层原理理解易混淆，需重点引导。|
|重 难 点 分    析|1. 重点：<br> - `RebootDevice()`函数调用（含`#include "reset.h"`头文件引入）；<br> - 编译配置修改（`BUILD.gn`添加头文件路径、`Makefile`添加链接库`-lreboot_example`）；<br> - 代码烧录后通过串口助手验证10秒自动重启功能。<br>2. 难点：<br> - 理解重启延迟（1.3秒左右）与看门狗初始化（`LzWatchdogInit()`）、超时设置（1秒）的关联逻辑；<br> - 编译报错（如头文件找不到、链接库缺失）的排查与解决。|
|信息化应用方法|网络教学平台、视频、开发板，开展现场教学，通过项目任务驱动进行混合式教学；|网络教学平台、视频、开发板，开展现场教学，通过项目任务驱动进行混合式教学；|网络教学平台、视频、开发板，开展现场教学，通过项目任务驱动进行混合式教学；|网络教学平台、视频、开发板，开展现场教学，通过项目任务驱动进行混合式教学；|
|思政元素 融合设计|思政元素|融入方式|融入方式|融入方式|
||民族自豪感、科技报国情怀|通过国产软件的崛起及应用事例的讲解，树立学生的民族自豪感和科技报国情怀|通过国产软件的崛起及应用事例的讲解，树立学生的民族自豪感和科技报国情怀|通过国产软件的崛起及应用事例的讲解，树立学生的民族自豪感和科技报国情怀|
|作业布置|1. 线上练习：完成学习通中“重启控制案例”相关选择题（含函数调用、编译配置考点）；<br>2. 线下实践：修改示例代码，将“10秒后重启”改为“5秒后重启”，并添加“即将重启”的串口打印提示，将代码与运行日志上传至学习平台；<br>3. 拓展思考：查阅参考资料，分析“看门狗重启”与“直接断电重启”的区别，撰写100字以内小结。|
|参考资料|1.OpenHarmony嵌入式系统原理与应用——基于RK2206芯片<br/>2.https://gitee.com/Lockzhiner-Electronics/lockzhiner-rk2206-openharmony3.0lts.git|1.OpenHarmony嵌入式系统原理与应用——基于RK2206芯片<br/>2.https://gitee.com/Lockzhiner-Electronics/lockzhiner-rk2206-openharmony3.0lts.git|1.OpenHarmony嵌入式系统原理与应用——基于RK2206芯片<br/>2.https://gitee.com/Lockzhiner-Electronics/lockzhiner-rk2206-openharmony3.0lts.git|1.OpenHarmony嵌入式系统原理与应用——基于RK2206芯片<br/>2.https://gitee.com/Lockzhiner-Electronics/lockzhiner-rk2206-openharmony3.0lts.git|


|教学环节|教学内容|教师活动|学生活动|设计意图|
|---|---|---|---|---|
|课前|预习（30分钟）|1. 在学习平台上传“重启控制案例”预习视频（含`RebootDevice()`函数简介、RK2206串口查看方法）；<br>2. 布置预习任务：回顾`BUILD.gn`文件基本结构，思考“函数调用为何需要引入头文件”。|1. 观看预习视频，记录疑问（如“看门狗是什么”）；<br>2. 复习`BUILD.gn`相关知识，完成预习思考题。|提前铺垫核心知识，减少课堂理解障碍，提高教学效率。|
|课中|课程介绍（5min）|1. 明确本节课目标：完成小凌派-RK2206开发板“10秒自动重启”功能开发与验证；<br>2. 结合OpenHarmony在物联网领域的应用案例（如智能设备系统），强调国产操作系统的重要性，融入思政元素。|1. 记录课堂目标，明确学习重点；<br>2. 聆听国产软件应用案例，初步建立科技报国认知。|让学生清晰学习方向，同时以案例激发学习兴趣与民族自豪感。|
||任务导入（10min）|1. 现场演示：烧录好重启代码的开发板，通过串口助手展示“10秒后重启”的日志效果；<br>2. 提出核心任务：“基于RK2206开发板，编写代码实现‘启动后倒计时10秒，打印计数日志，时间到后自动重启’，并完成编译烧录与验证”；<br>3. 拆解任务步骤：代码编写→`BUILD.gn`修改→`Makefile`修改→编译烧录→串口验证。|1. 观察演示效果，理解任务需求；<br>2. 记录任务拆解步骤，明确每一步核心动作。|通过直观演示降低任务复杂度，以“拆解步骤”帮助学生建立清晰的实施逻辑。|
||知识储备（15min）|1. 讲解核心函数：`RebootDevice()`的作用（触发系统重启）、调用注意事项（需等待1.3秒左右，依赖看门狗）；<br>2. 头文件与路径：说明`reset.h`的路径（`//base/iot_hardware/peripheral/interfaces/kits/reset.h`），演示如何在代码中引入（`#include "reset.h"`）；<br>3. `BUILD.gn`配置：以示例代码为例，讲解如何在`include_dirs`中添加头文件路径，确保编译器能找到`reset.h`；<br>4. 互动提问：“为什么要在`BUILD.gn`中添加头文件路径？”，引导学生思考编译原理。|1. 记录函数用法、头文件路径及`BUILD.gn`配置代码；<br>2. 参与互动，回答提问，深化对“头文件路径配置”的理解。|聚焦“代码编写前的知识准备”，通过提问强化关键知识点的理解，为后续实操打基础。|
||任务导入（5min）|1. 针对“编译配置”补充提问：“除了`BUILD.gn`，还有哪个文件需要修改？修改目的是什么？”；<br>2. 明确后续重点：讲解`Makefile`添加链接库（`-lreboot_example`）的方法，强调“不添加会导致链接失败”。|1. 思考并回答提问，回忆`Makefile`的作用；<br>2. 记录`Makefile`修改要点，标记易出错位置。|通过提问衔接前序知识，聚焦“编译配置”的易错点，提前规避实操中的问题。|
||知识储备（10min）|1. 看门狗原理简化讲解：以“定时喂狗”类比，说明`LzWatchdogInit()`（初始化）、`LzWatchdogSetTimeout(1)`（1秒超时）的作用——超时未“喂狗”则触发重启；<br>2. 代码逻辑分析：展示`reboot_process()`函数（含`while`循环计数、`LOS_Msleep(1000)`延时、计数到10调用`RebootDevice()`），讲解“打印计数日志”与“延时1秒”的实现逻辑。|1. 结合“定时喂狗”类比，理解看门狗与重启的关联；<br>2. 分析`reboot_process()`函数代码，标注关键语句（如`current == 10`的判断逻辑）。|用通俗类比降低底层原理理解难度，通过代码分析帮助学生掌握核心逻辑，为自主编写代码铺垫。|
||任务实施（40min）|1. 现场指导：巡视学生实操，针对共性问题（如`BUILD.gn`路径写错、串口助手波特率设置错误）集中讲解；<br>2. 个性化辅导：对代码报错、烧录失败的学生，一对一排查问题（如链接库未添加、开发板接线松动）；<br>3. 阶段性检查：每完成一个步骤（如代码编写、配置修改），随机抽查学生进度，确保无学生掉队。|1. 按步骤实操：<br> - 编写`reboot_example.c`代码（含`reboot_process()`函数、头文件引入）；<br> - 修改`BUILD.gn`（添加头文件路径）与`Makefile`（添加链接库）；<br> - 使用工具编译烧录，打开串口助手查看日志；<br>2. 遇到问题先自主排查（如对照参考资料检查代码），无法解决则举手提问。|通过“实操+指导”提升学生软件应用与问题解决能力，确保每个学生能独立完成核心任务。|
||任务总结（5min）|1. 成果验证：随机邀请2-3名学生展示串口日志，确认“10秒重启”功能实现；<br>2. 问题总结：梳理课堂共性问题（如`BUILD.gn`路径漏写`//`、串口波特率不匹配），强调注意事项；<br>3. 检查工单：确认所有学生提交“任务实施工单”（含代码截图、日志截图）。|1. 展示实操成果，分享遇到的问题与解决方法；<br>2. 记录共性问题，补充笔记；<br>3. 提交任务工单，确认自己的成果符合要求。|通过“成果展示”强化成就感，以“问题总结”巩固知识点，“工单检查”确保任务落地。|
|作业|学习通练习+实践任务|1. 在学习平台发布作业：线上选择题（10题，含函数调用、配置文件考点）+ 线下实践任务（修改代码、拓展思考）；<br>2. 提示：线下任务需在3天内上传至学习平台，教师将在平台批改并反馈。|1. 完成线上练习，即时查看错题解析；<br>2. 开展线下实践，修改代码、撰写拓展思考，按时上传成果。|通过“线上+线下”作业，巩固课堂知识，同时通过拓展思考提升自主学习与分析能力。|
|课后|资源上传与复习|1. 将课堂PPT、实验指导书（含代码模板、编译步骤细节）、常见问题排查手册上传至学习平台；<br>2. 汇总学生电子学习档案（含预习情况、工单提交、作业成果），标记需重点辅导的学生；<br>3. 发布复习提示：重点回顾`RebootDevice()`调用逻辑与编译配置步骤。|1. 登录学习平台，下载资源，对照笔记补全知识点；<br>2. 查看自己的学习档案，针对薄弱环节（如`Makefile`修改）重点复习；<br>3. 完成拓展任务中遇到的问题，可在平台留言提问。|提供全面的复习资源，帮助学生查缺补漏，同时通过“档案汇总”实现个性化辅导铺垫。|